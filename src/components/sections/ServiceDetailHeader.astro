---
/**
 * ServiceDetailHeader - Cabecera para páginas de servicios individuales
 * Componente reutilizable con estética black/white/red
 * 
 * Props:
 * - backLink: { href: string, text: string } - Link de regreso
 * - title: string - Título del servicio
 * - subtitle: string - Descripción del servicio
 * - backgroundImage?: string - URL de imagen de fondo (opcional)
 * 
 * Nota: Con soporte para imágenes de fondo optimizadas (WebP con fallback a JPG)
 */

interface Props {
  backLink: {
    href: string;
    text: string;
  };
  title: string;
  subtitle: string;
  backgroundImage?: string;
}

const { backLink, title, subtitle, backgroundImage } = Astro.props;

// Generar URL WebP automáticamente (con fallback a JPG si no existe)
const webpImageUrl = backgroundImage?.replace(/\.(jpg|jpeg|png)$/i, '.webp') || null;
---

<section class="relative min-h-[70vh] flex items-center overflow-hidden bg-black">
  <!-- Background Image (if provided) -->
  {backgroundImage && (
    <>
      <div class="absolute inset-0">
        <picture>
          {/* WebP version (primary) */}
          {webpImageUrl && (
            <source srcset={webpImageUrl} type="image/webp" />
          )}
          {/* JPG/PNG fallback */}
          <img
            src={backgroundImage}
            alt={title}
            class="h-full w-full object-cover object-center"
            loading="eager"
            decoding="async"
          />
        </picture>
      </div>
      <!-- Dark Overlay para legibilidad -->
      <div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/60 to-black/80"></div>
    </>
  )}

  <!-- Background Pattern (solo si NO hay imagen) -->
  {!backgroundImage && (
    <div class="absolute inset-0 opacity-5">
      <div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 40px 40px;"></div>
    </div>
  )}

  <!-- Red Accent Corner -->
  <div class="absolute right-0 top-0 h-64 w-64 bg-red-600 opacity-10 blur-3xl"></div>
  <div class="absolute left-0 bottom-0 h-64 w-64 bg-red-600 opacity-10 blur-3xl"></div>

  <!-- Content -->
  <div class="container relative z-10 py-32">
    <div class="mx-auto max-w-5xl">
      <!-- Back Link -->
      <a 
        href={backLink.href}
        class="group mb-12 inline-flex items-center text-sm font-bold uppercase tracking-wider text-gray-400 transition-all hover:text-red-600"
      >
        <svg 
          class="mr-2 h-5 w-5 transition-transform duration-300 group-hover:-translate-x-1" 
          fill="none" 
          viewBox="0 0 24 24" 
          stroke="currentColor" 
          stroke-width="2"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
        </svg>
        {backLink.text}
      </a>

      <div class="flex flex-col md:items-start">
        <!-- Text Content -->
        <div class="flex-1">
          <!-- Title (Mobile First) -->
          <h1 class="mb-6 text-3xl font-black uppercase leading-[1.1] tracking-tighter text-white sm:text-4xl md:text-5xl lg:text-6xl">
            {title}
          </h1>

          <!-- Subtitle (Mobile First) -->
          <p class="max-w-2xl text-base leading-relaxed text-gray-300 sm:text-lg md:text-xl lg:text-2xl">
            {subtitle}
          </p>

          <!-- Red Underline Accent -->
          <div class="mt-8 h-1 w-24 bg-red-600"></div>
        </div>
      </div>
    </div>
  </div>
</section>

