---
/**
 * Componente para inyectar Schema.org Structured Data
 * Usa @graph para múltiples schemas según especificación de Schema.org
 */

export interface Props {
  schema: Record<string, any> | Record<string, any>[];
}

const { schema } = Astro.props;

// Función para eliminar @context de schemas individuales (se define a nivel @graph)
function removeContext(obj: Record<string, any>): Record<string, any> {
  const { '@context': _, ...rest } = obj;
  return rest;
}

// Si es un array, usar @graph para agrupar múltiples schemas
// Eliminar @context de cada schema individual ya que se define a nivel global
const schemaData = Array.isArray(schema) 
  ? {
      '@context': 'https://schema.org',
      '@graph': schema.map(s => removeContext(s))
    }
  : schema;

// Serializar el schema a JSON-LD
const schemaJSON = JSON.stringify(schemaData, null, 2);
---

<script is:inline type="application/ld+json" set:html={schemaJSON}></script>

